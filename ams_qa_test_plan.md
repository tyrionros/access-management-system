# QA Test Plan & Checklist for Access Management System

## 1. Introduction & Scope

This document provides a comprehensive test plan and checklist for the Access Management System (AMS). The scope of this testing is to validate all functional requirements as defined in the user stories, ensure the security model is correctly implemented, and verify the end-to-end user experience.

**Testing Personas:** Testers should use accounts that have been assigned the specific security roles defined in `ams_security_roles.md`.
*   **Priya (Requestor):** Account with "Access Requestor" role.
*   **Anand (Approver):** Account with "Access Approver" role. Must be the manager of the Priya test account in Azure AD.
*   **Sam (Administrator):** Account with "Access Administrator" role.
*   **Rita (Auditor):** Account with "Read-Only Auditor" role.

---

## 2. Test Checklist

### 2.1 Test Suite: New Access Request (As Priya, the Requestor)

| Test Case ID | Test Scenario                                                   | Steps                                                                                                                                                                                            | Expected Result                                                                                                                                                           | Pass/Fail | Tester Notes |
| :----------- | :-------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------- | :----------- |
| **REQ-01**   | **Happy Path: Submit a complete and valid request**             | 1. Log in as Priya. <br/> 2. Navigate to the AMS App and click "New Request". <br/> 3. Follow the BPF wizard. <br/> 4. Select an Application. <br/> 5. Select a related Role. <br/> 6. Enter a justification. <br/> 7. Finish and save. | The request is created with a "Submitted" status. Priya can see the request in her "My Requests" view. Anand (manager) receives an email notification. The request form becomes read-only for Priya. |           |              |
| **REQ-02**   | **Negative Case: Role lookup filtering**                        | 1. Log in as Priya. <br/> 2. Start a new request. <br/> 3. DO NOT select an Application. <br/> 4. Attempt to select a Role.                                                                         | The Role lookup should be empty or disabled, preventing selection until an Application is chosen.                                                                                        |           |              |
| **REQ-03**   | **Negative Case: Missing justification**                        | 1. Log in as Priya. <br/> 2. Start a new request. <br/> 3. Select an Application and Role. <br/> 4. Leave the justification field blank. <br/> 5. Attempt to save/submit.                               | The system should show an error message stating that the justification is a required field. The request should not be submitted.                                                              |           |              |
| **REQ-04**   | **Security: Cannot see other users' requests**                  | 1. Log in as Priya. <br/> 2. Navigate to the "Access Requests" area. <br/> 3. Try to switch views to "All Requests" or search for requests created by other users.                                  | Priya should only be able to see requests where she is the requestor. Access to other views should be restricted or show no records.                                                        |           |              |

---

### 2.2 Test Suite: Approval Process (As Anand, the Approver)

| Test Case ID | Test Scenario                                        | Steps                                                                                                                                                                                             | Expected Result                                                                                                                                                                                                          | Pass/Fail | Tester Notes |
| :----------- | :--------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------- | :----------- |
| **APP-01**   | **Happy Path: Approve a request**                      | 1. Log in as Anand. <br/> 2. Open the approval email for REQ-01. <br/> 3. Click the link to open the request. <br/> 4. Add an approval comment. <br/> 5. Click "Approve".                               | The request status changes to "Approved". The approval comment and approver details are logged. Priya's user account is granted the requested D365 security role. A confirmation email is sent to Priya.                     |           |              |
| **APP-02**   | **Happy Path: Reject a request**                       | 1. Create a new request as Priya. <br/> 2. Log in as Anand. <br/> 3. Open the request from the email link. <br/> 4. Add a rejection reason comment. <br/> 5. Click "Reject".                            | The request status changes to "Rejected". The rejection comment is logged. The user is NOT granted the security role. A notification email with the rejection reason is sent to Priya.                                    |           |              |
| **APP-03**   | **Security: Cannot modify request details**            | 1. Log in as Anand. <br/> 2. Open an active request. <br/> 3. Attempt to change the Application, Role, or Justification fields entered by Priya.                                                        | All fields related to the original request should be read-only for the approver. Anand should only be able to add comments and use the approve/reject functions.                                                          |           |              |
| **APP-04**   | **Security: Non-manager cannot see approval request** | 1. Log in as a user who is NOT Anand (Priya's manager). <br/> 2. Attempt to navigate to the URL of the approval request.                                                                            | The user should receive an "Access Denied" or similar permissions error and should not be able to view or action the request.                                                                                           |           |              |

---

### 2.3 Test Suite: Administration (As Sam, the Administrator)

| Test Case ID | Test Scenario                                     | Steps                                                                                                                                                                                                           | Expected Result                                                                                                                                                                                            | Pass/Fail | Tester Notes |
| :----------- | :------------------------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------- | :----------- |
| **ADM-01**   | **Happy Path: Add a new Application and Role**    | 1. Log in as Sam. <br/> 2. Go to the Admin area. <br/> 3. Create a new `Application` record. <br/> 4. Create a new `Role` record. <br/> 5. Associate the new Role with the new Application.                           | The new Application and Role are saved correctly. When Priya creates a new request and selects this Application, the new Role is available to select.                                                                |           |              |
| **ADM-02**   | **Happy Path: Deactivate a Role**                 | 1. Log in as Sam. <br/> 2. Open an existing `Role` record. <br/> 3. Deactivate the record.                                                                                                                         | The deactivated role no longer appears in the Role lookup for new requests. Existing requests that used this role are unaffected.                                                                                   |           |              |
| **ADM-03**   | **Security: Full access to all requests**         | 1. Log in as Sam. <br/> 2. Go to the "Access Requests" view. <br/> 3. Change the view to "All Requests".                                                                                                            | Sam should be able to see all requests from all users in the system.                                                                                                                                       |           |              |
| **ADM-04**   | **Security: Manually override/update a request**  | 1. Log in as Sam. <br/> 2. Open an existing request. <br/> 3. Attempt to change fields, including the status.                                                                                                    | Sam should have full read/write permissions over all fields on the Access Request form, allowing for administrative correction if needed.                                                                           |           |              |

---

### 2.4 Test Suite: Auditing (As Rita, the Auditor)

| Test Case ID | Test Scenario                                       | Steps                                                                                                                                                                                                        | Expected Result                                                                                                                                                                                                                             | Pass/Fail | Tester Notes |
| :----------- | :-------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-------- | :----------- |
| **AUD-01**   | **Happy Path: View request history**                | 1. Log in as Rita. <br/> 2. Open an approved request record (e.g., APP-01).                                                                                                                                       | Rita can see all details: who requested it, when it was submitted, who approved it, their comments, and when it was approved. All fields are read-only.                                                                                             |           |              |
| **AUD-02**   | **Security: Cannot modify any data**                | 1. Log in as Rita. <br/> 2. Navigate to any record in the system (Request, Application, Role). <br/> 3. Attempt to change a value in any field or use any buttons like "Approve," "Reject," "Save," or "Deactivate." | All data entry fields should be locked/read-only. All action buttons should be hidden or disabled. Rita should not be able to make any changes to any data in the AMS.                                                                    |           |              |
| **AUD-03**   | **Happy Path: Access the Dataverse audit trail**    | 1. Log in as Rita (or with a user that has audit log access). <br/> 2. Open an approved request record. <br/> 3. Navigate to the "Audit History" for the record.                                                   | The audit log should clearly show a history of changes, including the change from "Submitted" to "Approved," who made the change (the system/flow user), and the timestamp.                                                                      |           |              |
